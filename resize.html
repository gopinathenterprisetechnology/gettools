<!DOCTYPE html>
<html>
<head>
<title>Image Resizer</title>
<style>
body{
font-family:Arial;
background:#111;
color:white;
text-align:center;
padding:20px;
}

.container{
background:#1e1e1e;
padding:20px;
border-radius:10px;
max-width:500px;
margin:auto;
}

input{
padding:8px;
margin:5px;
width:120px;
}

button{
padding:10px 20px;
margin-top:10px;
cursor:pointer;
}

#preview{
max-width:100%;
margin-top:20px;
border-radius:10px;
}

</style>
</head>
<body>

<div class="container">

<h2>Resize Image</h2>

<label>Width</label>
<input type="number" id="width">

<label>Height</label>
<input type="number" id="height">

<div id="dpiBox" style="display:none;">
<br>
<label>DPI</label>
<input type="number" id="dpi" value="300">
</div>

<br>
<label>
<input type="checkbox" id="ratio" checked>
Maintain Aspect Ratio
</label>

<br><br>
<button onclick="applyResize()">Resize Now</button>

<img id="preview">

</div>

<script>

let unit = localStorage.getItem("resizeUnit");
let imgSrc = localStorage.getItem("resizeImageData");

if(!imgSrc){
alert("No image found. Upload again.");
window.close();
}

let preview=document.getElementById("preview");
preview.src=imgSrc;

let originalWidth, originalHeight;

preview.onload=function(){

originalWidth = preview.naturalWidth;
originalHeight = preview.naturalHeight;

if(unit==="px"){
document.getElementById("width").value = originalWidth;
document.getElementById("height").value = originalHeight;
}

if(unit==="mm"){
document.getElementById("dpiBox").style.display="block";
let dpi=300;
document.getElementById("width").value=((originalWidth/dpi)*25.4).toFixed(2);
document.getElementById("height").value=((originalHeight/dpi)*25.4).toFixed(2);
}

if(unit==="cm"){
document.getElementById("dpiBox").style.display="block";
let dpi=300;
document.getElementById("width").value=((originalWidth/dpi)*2.54).toFixed(2);
document.getElementById("height").value=((originalHeight/dpi)*2.54).toFixed(2);
}

};

// Maintain ratio
document.getElementById("width").addEventListener("input",function(){

if(!document.getElementById("ratio").checked) return;

let ratio = originalHeight/originalWidth;
document.getElementById("height").value=(this.value*ratio).toFixed(2);

});

document.getElementById("height").addEventListener("input",function(){

if(!document.getElementById("ratio").checked) return;

let ratio = originalWidth/originalHeight;
document.getElementById("width").value=(this.value*ratio).toFixed(2);

});

function applyResize(){

let w=document.getElementById("width").value;
let h=document.getElementById("height").value;
let dpi=document.getElementById("dpi").value || 300;

if(unit==="mm"){
w=(w/25.4)*dpi;
h=(h/25.4)*dpi;
}

if(unit==="cm"){
w=(w/2.54)*dpi;
h=(h/2.54)*dpi;
}

w=parseInt(w);
h=parseInt(h);

let canvas=document.createElement("canvas");
canvas.width=w;
canvas.height=h;

let ctx=canvas.getContext("2d");
ctx.drawImage(preview,0,0,w,h);

preview.src=canvas.toDataURL("image/jpeg",1);

originalWidth=w;
originalHeight=h;

alert("Image Resized Successfully!");

}

</script>

</body>
</html>
