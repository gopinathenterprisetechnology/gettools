<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced Image Compressor - GET Tools</title>

<style>
body{
font-family:Arial;
background:#f3f3f3;
margin:0;
padding:20px;
text-align:center;
}

.dimension-toggle{
display:inline-block;
background:#eee;
padding:8px 15px;
border-radius:20px;
margin-bottom:20px;
}

.dimension-toggle button{
border:none;
background:none;
padding:6px 12px;
cursor:pointer;
font-weight:bold;
}

.dimension-toggle .active{
background:#d6d6d6;
border-radius:15px;
}

.upload-area{
border:3px dashed #8a8ad4;
border-radius:15px;
padding:60px;
margin-bottom:20px;
background:white;
cursor:pointer;
}

.card{
width:320px;
margin:auto;
background:#49799c;
color:white;
border-radius:10px;
display:none;
overflow:hidden;
}

.preview-box{
background:white;
padding:15px;
position:relative;
}

.preview-box img{
max-width:100%;
}

.top-btn{
position:absolute;
top:10px;
left:10px;
}

.top-btn button{
background:#3b6e90;
color:white;
border:none;
padding:5px 10px;
margin:3px;
border-radius:20px;
cursor:pointer;
font-size:12px;
}

.close-btn{
position:absolute;
top:10px;
right:10px;
cursor:pointer;
font-weight:bold;
color:black;
}

.info{
padding:15px;
text-align:left;
}

.controls{
margin-top:30px;
}

.reduce-btn{
background:#5661b3;
color:white;
border:none;
padding:10px 20px;
border-radius:6px;
cursor:pointer;
}

.resize-input{
margin-top:10px;
}

.resize-input input{
width:70px;
}
</style>
</head>
<body>

<div class="dimension-toggle">
Image Dimensions:-
<button class="active" onclick="setUnit('px',this)">Pixels</button>
<button onclick="setUnit('mm',this)">MM</button>
<button onclick="setUnit('cm',this)">CM</button>
</div>

<div class="upload-area" onclick="fileInput.click()">
Click or Drag Image Here
<input type="file" id="fileInput" accept="image/*" hidden>
</div>

<div class="card" id="card">

<div class="preview-box">
<div class="top-btn">
<button onclick="resizeImage()">Resize</button>
</div>
<div class="close-btn" onclick="removeImage()">âœ–</div>
<img id="preview">
</div>

<div class="info">
<p id="fileName"></p>
<p><strong>Size:</strong> <span id="fileSize"></span></p>
<p><strong>Width:</strong> <span id="imgWidth"></span></p>
<p><strong>Height:</strong> <span id="imgHeight"></span></p>

<div class="resize-input">
Width: <input type="number" id="newWidth">
Height: <input type="number" id="newHeight">
<label>
<input type="checkbox" id="ratioCheck" checked> Maintain Ratio
</label>
</div>

</div>
</div>

<div class="controls">
Size: <input type="number" id="targetSize" value="100" style="width:70px;"> KB
<button class="reduce-btn" onclick="compress()">Reduce Size</button>
</div>

<script>

let originalFile;
let currentUnit="px";
let imgWidthPx, imgHeightPx;

const fileInput=document.getElementById("fileInput");

fileInput.addEventListener("change",function(e){
let file=e.target.files[0];
if(!file) return;

originalFile=file;

let reader=new FileReader();
reader.onload=function(event){

let img=new Image();
img.src=event.target.result;

img.onload=function(){

imgWidthPx=img.width;
imgHeightPx=img.height;

document.getElementById("preview").src=event.target.result;
document.getElementById("fileName").innerText=file.name;
document.getElementById("fileSize").innerText=(file.size/1024).toFixed(2)+" KB";

updateDimensions();

document.getElementById("newWidth").value=imgWidthPx;
document.getElementById("newHeight").value=imgHeightPx;

document.getElementById("card").style.display="block";
};
};
reader.readAsDataURL(file);
});

function setUnit(unit,btn){
currentUnit=unit;
document.querySelectorAll(".dimension-toggle button").forEach(b=>b.classList.remove("active"));
btn.classList.add("active");
updateDimensions();
}

function updateDimensions(){
let w=imgWidthPx;
let h=imgHeightPx;

if(currentUnit==="mm"){
w=(w*0.2646).toFixed(1);
h=(h*0.2646).toFixed(1);
}
if(currentUnit==="cm"){
w=(w*0.02646).toFixed(2);
h=(h*0.02646).toFixed(2);
}

document.getElementById("imgWidth").innerText=w+" "+currentUnit.toUpperCase();
document.getElementById("imgHeight").innerText=h+" "+currentUnit.toUpperCase();
}

function removeImage(){
document.getElementById("card").style.display="none";
fileInput.value="";
}

document.getElementById("newWidth").addEventListener("input",function(){
if(document.getElementById("ratioCheck").checked){
let ratio=imgHeightPx/imgWidthPx;
document.getElementById("newHeight").value=Math.round(this.value*ratio);
}
});

function resizeImage(){

let newWidth=parseInt(document.getElementById("newWidth").value);
let newHeight=parseInt(document.getElementById("newHeight").value);

if(!newWidth || !newHeight) return;

let reader=new FileReader();
reader.onload=function(e){

let img=new Image();
img.src=e.target.result;

img.onload=function(){

let canvas=document.createElement("canvas");
canvas.width=newWidth;
canvas.height=newHeight;
let ctx=canvas.getContext("2d");
ctx.drawImage(img,0,0,newWidth,newHeight);

let resized=canvas.toDataURL("image/jpeg",0.95);

document.getElementById("preview").src=resized;

imgWidthPx=newWidth;
imgHeightPx=newHeight;

updateDimensions();
};
};
reader.readAsDataURL(originalFile);
}

function compress(){

let targetKB=document.getElementById("targetSize").value;
let maxBytes=targetKB*1024;

let img=document.getElementById("preview");
let canvas=document.createElement("canvas");
canvas.width=imgWidthPx;
canvas.height=imgHeightPx;
let ctx=canvas.getContext("2d");

let temp=new Image();
temp.src=img.src;

temp.onload=function(){

ctx.drawImage(temp,0,0);

let quality=0.9;
let compressed=canvas.toDataURL("image/jpeg",quality);

while((compressed.length*3/4)>maxBytes && quality>0.1){
quality-=0.05;
compressed=canvas.toDataURL("image/jpeg",quality);
}

document.getElementById("preview").src=compressed;
};
}

</script>
</body>
</html>
