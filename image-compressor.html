<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Image Compressor Pro v2.0</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<style>
body{
margin:0;
font-family:Segoe UI;
background:#0f172a;
color:white;
display:flex;
justify-content:center;
align-items:center;
min-height:100vh;
}

.container{
width:900px;
background:#1e293b;
padding:25px;
border-radius:15px;
box-shadow:0 0 30px rgba(0,0,0,0.5);
}

h1{
text-align:center;
margin-bottom:20px;
}

.drop-zone{
border:2px dashed #38bdf8;
padding:30px;
text-align:center;
cursor:pointer;
border-radius:10px;
margin-bottom:20px;
}

.preview-area{
display:flex;
gap:20px;
margin-top:20px;
}

.preview-box{
flex:1;
background:#0f172a;
padding:10px;
border-radius:10px;
text-align:center;
}

.preview-box img{
max-width:100%;
max-height:250px;
}

.controls{
margin-top:20px;
display:grid;
grid-template-columns:1fr 1fr;
gap:15px;
}

input,select{
padding:8px;
border-radius:5px;
border:none;
}

button{
padding:10px;
border:none;
border-radius:6px;
cursor:pointer;
background:#38bdf8;
color:black;
font-weight:bold;
}

button:hover{
background:#0ea5e9;
}

.footer{
margin-top:15px;
text-align:center;
font-size:14px;
color:#94a3b8;
}
</style>
  <div id="resizePanel" style="display:none; grid-column:1/3; background:#0f172a; padding:15px; border-radius:10px;">

<h3>Resize Options</h3>

<label>Unit</label>
<select id="unit">
<option value="px">Pixel</option>
<option value="mm">Millimeter</option>
<option value="cm">Centimeter</option>
</select>

<label>DPI</label>
<input type="number" id="dpi" value="300">

<label>Width <span id="unitLabelW">px</span></label>
<input type="number" id="width">

<label>Height <span id="unitLabelH">px</span></label>
<input type="number" id="height">

<label>
<input type="checkbox" id="ratio" checked>
Maintain Aspect Ratio
</label>

</div>
</head>
  
<body>

<div class="container">
<h1>Image Compressor Pro v2.0</h1>

<div class="drop-zone" id="dropZone">
Click or Drag Image Here
<input type="file" id="fileInput" hidden>
</div>

<div class="preview-area">
<div class="preview-box">
<h3>Original</h3>
<div id="originalPreview"></div>
<p id="originalSize"></p>
</div>

<div class="preview-box">
<h3>Compressed</h3>
<div id="compressedPreview"></div>
<p id="compressedSize"></p>
</div>
</div>

<div class="controls">
<div>
<label>Quality (JPG/WEBP)</label>
<input type="range" id="quality" min="0.1" max="1" step="0.1" value="0.8">
</div>
<div>
<label>Target Size (KB)</label>
<input type="number" id="targetKB" placeholder="Enter KB">
</div>
<div>
<label>Format</label>
<select id="format">
<option value="image/jpeg">JPG</option>
<option value="image/webp">WEBP</option>
<option value="image/png">PNG</option>
</select>
</div>
<div id="resizeSection" style="display:none; margin-top:15px;">
<div>
<label>Resize Unit</label>
<select id="unit">
<option value="px">Pixel</option>
<option value="mm">Millimeter</option>
<option value="cm">Centimeter</option>
</select>
</div>

<div>
<label>DPI (mm/cm only)</label>
<input type="number" id="dpi" value="300">
</div>

<div>
<label>Width</label>
<input type="number" id="width">
</div>

<div>
<label>Height</label>
<input type="number" id="height">
</div>

<div>
<label><input type="checkbox" id="ratio" checked> Maintain Aspect Ratio</label>
</div>
</div>
<div>
 <button type="button" onclick="toggleResize()">Resize</button>
<button onclick="compressImage()">Compress</button>
<button onclick="downloadImage()">Download</button>
<button onclick="downloadAll()">Download All(ZIP)</button>
<button onclick="resetAll()">Reset</button>
</div>

</div>

<div class="footer">
Professional Image Compressor â€“ Upgrade Edition
</div>

</div>

<script>

let images = [];
let compressedImages = [];

const dropZone = document.getElementById("dropZone");
const fileInput = document.getElementById("fileInput");
fileInput.multiple = true;

// Toggle Resize Panel
function toggleResize(){
let section = document.getElementById("resizeSection");

if(section.style.display === "none"){
section.style.display = "block";
}else{
section.style.display = "none";
}
}

// Upload
dropZone.onclick = () => fileInput.click();

fileInput.onchange = function(e){
handleFiles(e.target.files);
};

function handleFiles(files){

images=[];
compressedImages=[];
document.getElementById("originalPreview").innerHTML="";
document.getElementById("compressedPreview").innerHTML="";

Array.from(files).forEach(file=>{

let reader=new FileReader();

reader.onload=function(e){

let img=new Image();

img.onload=function(){

images.push({file,img});

let preview=document.createElement("img");
preview.src=img.src;
preview.style.maxWidth="150px";
preview.style.margin="5px";

document.getElementById("originalPreview").appendChild(preview);

};

img.src=e.target.result;
};

reader.readAsDataURL(file);

});

}

// Convert
function convertToPx(value){

let unit=document.getElementById("unit").value;
let dpi=document.getElementById("dpi").value;

if(unit==="px") return value;
if(unit==="mm") return (value/25.4)*dpi;
if(unit==="cm") return (value/2.54)*dpi;

}

// Compress All
async function compressImage(){

compressedImages=[];
document.getElementById("compressedPreview").innerHTML="";

let format=document.getElementById("format").value;
let quality=document.getElementById("quality").value;
let targetKB=document.getElementById("targetKB").value;

for(let item of images){

let canvas=document.createElement("canvas");
let ctx=canvas.getContext("2d");

let w=item.img.width;
let h=item.img.height;

if(document.getElementById("resizePanel").style.display==="block"){

w=convertToPx(document.getElementById("width").value);
h=convertToPx(document.getElementById("height").value);

}

canvas.width=w;
canvas.height=h;

ctx.drawImage(item.img,0,0,w,h);

let blob;

if(targetKB){

let targetBytes=targetKB*1024;

for(let q=0.9;q>0.1;q-=0.05){

blob=await new Promise(r=>canvas.toBlob(r,format,q));

if(blob.size<=targetBytes) break;

}

}else{

blob=await new Promise(r=>canvas.toBlob(r,format,quality));

}

compressedImages.push({name:item.file.name,blob});

let imgPreview=document.createElement("img");
imgPreview.src=URL.createObjectURL(blob);
imgPreview.style.maxWidth="150px";
imgPreview.style.margin="5px";

document.getElementById("compressedPreview").appendChild(imgPreview);

}

}

// Download Single
function downloadImage(){

if(compressedImages.length===0) return alert("Compress first");

compressedImages.forEach(item=>{

let a=document.createElement("a");
a.href=URL.createObjectURL(item.blob);
a.download="compressed_"+item.name;
a.click();

});

}

// Download All ZIP
async function downloadAll(){

if(compressedImages.length===0) return alert("Compress first");

let zip=new JSZip();

compressedImages.forEach(item=>{
zip.file("compressed_"+item.name,item.blob);
});

let content=await zip.generateAsync({type:"blob"});

let a=document.createElement("a");
a.href=URL.createObjectURL(content);
a.download="All_Compressed_Images.zip";
a.click();

}
</script>

</body>
</html>
